# APIæµ‹è¯•ç”ŸæˆåŠŸèƒ½å®ç°æ€»ç»“

## âœ… å·²å®ç°çš„åŠŸèƒ½

### 1. **APIæ–‡æ¡£è§£æå™¨** (`backend/app/utils/api_doc_parser.py`)

æ”¯æŒä»¥ä¸‹æ ¼å¼ï¼š
- âœ… **OpenAPI/Swagger** (JSON/YAMLæ ¼å¼)
- âœ… **Postman Collection** (JSONæ ¼å¼)

**åŠŸèƒ½ç‰¹æ€§ï¼š**
- è‡ªåŠ¨æ£€æµ‹æ–‡æ¡£æ ¼å¼
- æå–æ‰€æœ‰æ¥å£ä¿¡æ¯ï¼ˆè·¯å¾„ã€æ–¹æ³•ã€å‚æ•°ã€è¯·æ±‚ä½“ã€å“åº”ç­‰ï¼‰
- æå–åŸºç¡€URL
- ç”Ÿæˆæ–‡æ¡£æ‘˜è¦ç”¨äºAIç”Ÿæˆ

**è§£æç»“æœç»“æ„ï¼š**
```python
{
    "type": "openapi" | "postman",
    "version": "3.0.0",
    "info": {...},
    "base_url": "https://api.example.com",
    "endpoints": [
        {
            "path": "/api/users",
            "method": "GET",
            "summary": "...",
            "parameters": [...],
            "request_body": {...},
            "responses": {...}
        }
    ]
}
```

### 2. **åç«¯APIç«¯ç‚¹**

#### `/ai/parse-api-document` (POST)
- æ¥æ”¶APIæ–‡æ¡£æ–‡ä»¶ï¼ˆJSON/YAMLï¼‰
- è§£ææ–‡æ¡£å¹¶è¿”å›ç»“æ„åŒ–æ•°æ®
- è¿”å›æ¥å£æ‘˜è¦å’Œç»Ÿè®¡ä¿¡æ¯

#### `/ai/generate-api-tests` (POST) - å·²å¢å¼º
- æ”¯æŒä¼ é€’ `parsed_doc` å‚æ•°
- è¶…æ—¶æ—¶é—´å¢åŠ åˆ°5åˆ†é’Ÿï¼ˆç”Ÿæˆæ‰€æœ‰æ¥å£éœ€è¦æ›´é•¿æ—¶é—´ï¼‰
- è¿”å›å·¥ç¨‹åŒ–çš„ä»£ç ç»“æ„

### 3. **AIå¼•æ“ä»£ç ç”Ÿæˆå™¨** (`ai_engine/processors/api_test_generator.py`)

**æ”¹è¿›å†…å®¹ï¼š**
- âœ… ç”Ÿæˆå·¥ç¨‹åŒ–çš„ä»£ç ç»“æ„
- âœ… æ”¯æŒä¸ºæ‰€æœ‰æ¥å£ç”Ÿæˆæµ‹è¯•ä»£ç 
- âœ… ç”Ÿæˆå®Œæ•´çš„é¡¹ç›®ç»“æ„å»ºè®®

**ç”Ÿæˆçš„ä»£ç ç»“æ„ï¼š**
```json
{
    "status": "success",
    "project_structure": {
        "description": "é¡¹ç›®ç»“æ„è¯´æ˜",
        "directories": ["tests/", "config/", "utils/", "data/"],
        "files": ["tests/api/test_*.py", "config/settings.py", ...]
    },
    "api_client_class": {
        "class_name": "APIClient",
        "code": "class APIClient: ..."
    },
    "config_file": {
        "file_name": "config/settings.py",
        "code": "BASE_URL = ..."
    },
    "api_tests": [
        {
            "file_name": "tests/api/test_user_api.py",
            "class_name": "TestUserAPI",
            "full_class_code": "å®Œæ•´çš„æµ‹è¯•ç±»ä»£ç ",
            "test_methods": [...]
        }
    ],
    "conftest": {
        "code": "pytesté…ç½®ä»£ç "
    },
    "requirements": {
        "packages": ["requests", "pytest", ...]
    },
    "readme": {
        "content": "é¡¹ç›®è¯´æ˜æ–‡æ¡£"
    }
}
```

### 4. **å‰ç«¯å®ç°** (`frontend/src/pages/AIEngine.tsx`)

**æ–°å¢åŠŸèƒ½ï¼š**
- âœ… APIæ–‡æ¡£ä¸Šä¼ æŒ‰é’®ï¼ˆåœ¨APIæ–‡æ¡£è¾“å…¥æ¡†æ—è¾¹ï¼‰
- âœ… æ”¯æŒä¸Šä¼ OpenAPI/Swaggerã€Postman Collectionæ–‡ä»¶
- âœ… è‡ªåŠ¨è§£æå¹¶å¡«å……è¡¨å•
- âœ… æ˜¾ç¤ºè§£æç»“æœï¼ˆæ¥å£æ•°é‡ã€åŸºç¡€URLç­‰ï¼‰
- âœ… ä¼ é€’è§£æåçš„æ–‡æ¡£ç»“æ„ç»™AIç”Ÿæˆå™¨

**æ”¹è¿›å†…å®¹ï¼š**
- âœ… ä»£ç æå–é€»è¾‘æ”¯æŒå·¥ç¨‹åŒ–ç»“æ„
- âœ… å±•ç¤ºå®Œæ•´çš„é¡¹ç›®ç»“æ„ã€é…ç½®æ–‡ä»¶ã€æµ‹è¯•æ–‡ä»¶ç­‰
- âœ… æ”¯æŒä¸‹è½½å®Œæ•´çš„å·¥ç¨‹åŒ–ä»£ç 

### 5. **å‰ç«¯æœåŠ¡** (`frontend/src/services/aiService.ts`)

**æ–°å¢å‡½æ•°ï¼š**
- `parseAPIDocument()` - è§£æAPIæ–‡æ¡£
- `generateAPITests()` - æ”¯æŒ `parsed_doc` å‚æ•°

---

## ğŸ“ ç”Ÿæˆçš„ä»£ç ç»“æ„ç¤ºä¾‹

```
api_test_project/
â”œâ”€â”€ README.md                 # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ requirements.txt          # ä¾èµ–åŒ…åˆ—è¡¨
â”œâ”€â”€ conftest.py              # pytesté…ç½®æ–‡ä»¶
â”œâ”€â”€ config/
â”‚   â””â”€â”€ settings.py          # é…ç½®æ–‡ä»¶ï¼ˆbase_urlç­‰ï¼‰
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ api_client.py         # APIå®¢æˆ·ç«¯å·¥å…·ç±»
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ api/
â”‚       â”œâ”€â”€ test_user_api.py      # ç”¨æˆ·ç›¸å…³æ¥å£æµ‹è¯•
â”‚       â”œâ”€â”€ test_product_api.py   # äº§å“ç›¸å…³æ¥å£æµ‹è¯•
â”‚       â””â”€â”€ test_order_api.py      # è®¢å•ç›¸å…³æ¥å£æµ‹è¯•
â””â”€â”€ data/
    â””â”€â”€ test_data.json       # æµ‹è¯•æ•°æ®ï¼ˆå¯é€‰ï¼‰
```

### ä»£ç ç‰¹ç‚¹

1. **APIClientç±»** - å°è£…é€šç”¨è¯·æ±‚æ–¹æ³•
   ```python
   class APIClient:
       def __init__(self, base_url, timeout=30):
           self.base_url = base_url
           self.timeout = timeout
       
       def request(self, method, endpoint, **kwargs):
           # é€šç”¨è¯·æ±‚æ–¹æ³•
       
       def get(self, endpoint, **kwargs):
           # GETæ–¹æ³•
       
       def post(self, endpoint, **kwargs):
           # POSTæ–¹æ³•
   ```

2. **æµ‹è¯•ç±»ç»“æ„** - ä½¿ç”¨pytestæ¡†æ¶
   ```python
   class TestUserAPI:
       def setup_method(self):
           # æµ‹è¯•å‰ç½®è®¾ç½®
       
       def test_get_user_success(self):
           # æˆåŠŸåœºæ™¯æµ‹è¯•
       
       def test_get_user_error(self):
           # é”™è¯¯åœºæ™¯æµ‹è¯•
   ```

3. **é…ç½®æ–‡ä»¶** - é›†ä¸­ç®¡ç†é…ç½®
   ```python
   # config/settings.py
   BASE_URL = "https://api.example.com"
   TIMEOUT = 30
   ```

4. **conftest.py** - pytest fixtures
   ```python
   import pytest
   from utils.api_client import APIClient
   
   @pytest.fixture
   def api_client():
       return APIClient(BASE_URL)
   ```

---

## ğŸš€ ä½¿ç”¨æµç¨‹

1. **ä¸Šä¼ APIæ–‡æ¡£**
   - ç‚¹å‡»"ä¸Šä¼ APIæ–‡æ¡£"æŒ‰é’®
   - é€‰æ‹©OpenAPI/Swaggeræˆ–Postman Collectionæ–‡ä»¶
   - ç³»ç»Ÿè‡ªåŠ¨è§£æå¹¶å¡«å……è¡¨å•

2. **é…ç½®æµ‹è¯•å‚æ•°**
   - æ£€æŸ¥/ä¿®æ”¹åŸºç¡€URL
   - é€‰æ‹©æµ‹è¯•åœºæ™¯ï¼ˆnormal, error, boundary, performanceï¼‰

3. **ç”Ÿæˆæµ‹è¯•ä»£ç **
   - ç‚¹å‡»"ç”ŸæˆAPIæµ‹è¯•"æŒ‰é’®
   - AIä¼šä¸ºæ‰€æœ‰æ¥å£ç”Ÿæˆæµ‹è¯•ä»£ç 
   - ç”Ÿæˆå·¥ç¨‹åŒ–çš„é¡¹ç›®ç»“æ„

4. **æŸ¥çœ‹å’Œä¸‹è½½**
   - æŸ¥çœ‹ç”Ÿæˆçš„ä»£ç ç»“æ„
   - å¤åˆ¶ä»£ç æˆ–ä¸‹è½½ä¸ºæ–‡ä»¶
   - ä»£ç å¯ä»¥ç›´æ¥è¿è¡Œ

---

## ğŸ“‹ ä¾èµ–è¦æ±‚

### åç«¯ä¾èµ–
- `PyYAML==6.0.1` - ç”¨äºè§£æYAMLæ ¼å¼çš„APIæ–‡æ¡£ï¼ˆå·²æ·»åŠ åˆ°requirements.txtï¼‰

### å‰ç«¯
- æ— éœ€é¢å¤–ä¾èµ–

---

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### APIæ–‡æ¡£è§£ææµç¨‹

1. **æ–‡ä»¶ä¸Šä¼ ** â†’ å‰ç«¯ä¸Šä¼ æ–‡ä»¶åˆ° `/ai/parse-api-document`
2. **æ ¼å¼æ£€æµ‹** â†’ æ ¹æ®æ–‡ä»¶æ‰©å±•åå’Œå†…å®¹è‡ªåŠ¨æ£€æµ‹æ ¼å¼
3. **è§£ææ–‡æ¡£** â†’ æå–æ‰€æœ‰æ¥å£ä¿¡æ¯
4. **ç”Ÿæˆæ‘˜è¦** â†’ ç”Ÿæˆæ–‡æ¡£æ‘˜è¦ç”¨äºAIç”Ÿæˆ
5. **è¿”å›ç»“æœ** â†’ è¿”å›è§£æåçš„æ–‡æ¡£ç»“æ„å’Œæ‘˜è¦

### ä»£ç ç”Ÿæˆæµç¨‹

1. **æ¥æ”¶è¯·æ±‚** â†’ åŒ…å«APIæ–‡æ¡£å’Œè§£æåçš„æ–‡æ¡£ç»“æ„
2. **æ„å»ºæç¤ºè¯** â†’ åŒ…å«æ‰€æœ‰æ¥å£ä¿¡æ¯å’Œå·¥ç¨‹åŒ–è¦æ±‚
3. **AIç”Ÿæˆ** â†’ è°ƒç”¨AIç”Ÿæˆå·¥ç¨‹åŒ–çš„æµ‹è¯•ä»£ç 
4. **è§£æå“åº”** â†’ è§£æJSONæ ¼å¼çš„ä»£ç ç»“æ„
5. **è¿”å›ç»“æœ** â†’ è¿”å›å®Œæ•´çš„å·¥ç¨‹åŒ–ä»£ç ç»“æ„

---

## âœ¨ åŠŸèƒ½ç‰¹ç‚¹

1. **è‡ªåŠ¨åŒ–** - ä¸Šä¼ æ–‡æ¡£å³å¯è‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰æ¥å£çš„æµ‹è¯•ä»£ç 
2. **å·¥ç¨‹åŒ–** - ç”Ÿæˆå®Œæ•´çš„é¡¹ç›®ç»“æ„ï¼Œä»£ç ç»„ç»‡æ¸…æ™°
3. **å¯ç›´æ¥è¿è¡Œ** - ç”Ÿæˆçš„ä»£ç åŒ…å«æ‰€æœ‰å¿…è¦çš„é…ç½®å’Œä¾èµ–
4. **æ¨¡å—åŒ–** - ä½¿ç”¨ç±»å’Œå‡½æ•°ç»„ç»‡ä»£ç ï¼Œæ˜“äºç»´æŠ¤
5. **å®Œæ•´è¦†ç›–** - ä¸ºæ¯ä¸ªæ¥å£ç”ŸæˆæˆåŠŸå’Œé”™è¯¯åœºæ™¯çš„æµ‹è¯•

---

## ğŸ“ ä¸‹ä¸€æ­¥æ”¹è¿›å»ºè®®

1. **æ”¯æŒæ›´å¤šæ–‡æ¡£æ ¼å¼**
   - RAML
   - API Blueprint
   - GraphQL Schema

2. **å¢å¼ºä»£ç ç”Ÿæˆ**
   - æ”¯æŒæ›´å¤šæµ‹è¯•æ¡†æ¶ï¼ˆunittest, nose2ç­‰ï¼‰
   - ç”Ÿæˆæµ‹è¯•æ•°æ®æ–‡ä»¶
   - ç”ŸæˆCI/CDé…ç½®

3. **ä»£ç è´¨é‡**
   - ä»£ç æ ¼å¼åŒ–
   - ç±»å‹æç¤º
   - æ–‡æ¡£å­—ç¬¦ä¸²ç”Ÿæˆ

4. **æµ‹è¯•æ‰§è¡Œ**
   - é›†æˆæµ‹è¯•æ‰§è¡ŒåŠŸèƒ½
   - å®æ—¶æŸ¥çœ‹æµ‹è¯•ç»“æœ
   - æµ‹è¯•æŠ¥å‘Šç”Ÿæˆ

